<html>
<head>
<script src="gadgets.js"></script>
<script src="rop.js"></script>
<script type="text/javascript">
function download(data, filename) {
	var blob_obj = new Blob(data, {type: "octet/stream"});
	var url = window.URL.createObjectURL(blob_obj);
	var download_link = document.createElement("a");
	download_link.href = url;
	download_link.download = filename;
	document.body.appendChild(download_link);
	download_link.click();
	document.body.removeChild(download_link);
	return;
}

function CreatePayload() {
	window.old_fw = false;
	window.psvita_fw = window.prompt("PSVita FW ?", 161);
	
	if(resolve()) {
		var payload_name = window.prompt("payload name ?", "");
		if (payload_name == "second") {
			init_payload(window.second_payload_base_addr, 0, 0x20000, window.second_payload_size);
			make_second_payload();
			download([payload_buf], payload_name + ".bin");
		} else if (payload_name == "dumper") {
			init_payload(window.dumper_payload_base_addr, 0, 0x20000, window.dumper_payload_size);
			make_dumper_payload();
			download([payload_buf], payload_name + ".bin");
		} else alert("payload not setupped !")
	}
}
</script>
</head>
<body>

<input type="button" onclick="CreatePayload();" value="Create Payload" />

</body>
</html>